<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title></title>
    <link href="/2025/04/02/IT/"/>
    <url>/2025/04/02/IT/</url>
    
    <content type="html"><![CDATA[<h2 id="ITU-R-BT-709-亮度公式说明"><a href="#ITU-R-BT-709-亮度公式说明" class="headerlink" title="ITU-R BT.709 亮度公式说明"></a>ITU-R BT.709 亮度公式说明</h2><p>ITU-R BT.709 是国际电信联盟（ITU）制定的高清电视（HDTV）色彩空间标准，广泛用于广播电视、数字视频和图像处理领域。其核心是 <strong>亮度（Luminance）计算公式</strong>，用于将RGB颜色空间转换为亮度（Y）通道。</p><h3 id="1-公式定义"><a href="#1-公式定义" class="headerlink" title="1. 公式定义"></a><strong>1. 公式定义</strong></h3><p>ITU-R BT.709 亮度公式的数学表达式为：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs math">Y = 0.299 \cdot R + 0.587 \cdot G + 0.114 \cdot B<br></code></pre></td></tr></table></figure><p>其中：</p><ul><li>R,G,B<em>R</em>,<em>G</em>,<em>B</em> 表示归一化后的三原色分量（取值范围通常为 <code>[0, 1]</code> 或 <code>[0, 255]</code>）</li><li>Y<em>Y</em> 表示计算得到的亮度值</li><li><em>R</em>′,<em>G</em>′,<em>B</em>′：经过伽马校正后的非线性RGB信号（取值范围通常为0-1或数字量化值，如8位时为16-235）。</li><li><strong>系数权重</strong>：0.2126（红）、0.7152（绿）、0.0722（蓝），总和为1，反映了人眼对绿光最敏感、红光次之、蓝光最弱的生理特性。</li></ul><h3 id="2-技术原理"><a href="#2-技术原理" class="headerlink" title="2. 技术原理"></a><strong>2. 技术原理</strong></h3><h4 id="1-人眼感知特性"><a href="#1-人眼感知特性" class="headerlink" title="(1) 人眼感知特性"></a><strong>(1) 人眼感知特性</strong></h4><ul><li><p>权重分配</p><p>：公式中的系数（0.299, 0.587, 0.114）基于人眼对不同波长光的敏感度：</p><ul><li>绿色光（555nm）敏感度最高 → G分量权重最大（58.7%）</li><li>红色光（611nm）次之 → R分量权重29.9%</li><li>蓝色光（464nm）最弱 → B分量权重11.4%</li></ul></li></ul><h4 id="2-色彩空间映射"><a href="#2-色彩空间映射" class="headerlink" title="(2) 色彩空间映射"></a><strong>(2) 色彩空间映射</strong></h4><ul><li><strong>目的</strong>：将非线性感知的RGB颜色映射到线性亮度空间</li><li><strong>兼容性</strong>：与sRGB标准中的亮度计算完全一致</li></ul><h3 id="3-代码实现"><a href="#3-代码实现" class="headerlink" title="3. 代码实现"></a><strong>3. 代码实现</strong></h3><h4 id="Python示例"><a href="#Python示例" class="headerlink" title="Python示例"></a><strong>Python示例</strong></h4><figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ceylon">Pythondef rgb<span class="hljs-number">_</span>to<span class="hljs-number">_</span>luminance(rgb<span class="hljs-number">_</span>array):<br>    <span class="hljs-string">&quot;&quot;&quot;将RGB数组转换为BT.709亮度矩阵&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0.2</span><span class="hljs-number">99</span> * rgb<span class="hljs-number">_</span>array[..., <span class="hljs-number">0</span>] + \<br>           <span class="hljs-number">0.5</span><span class="hljs-number">87</span> * rgb<span class="hljs-number">_</span>array[..., <span class="hljs-number">1</span>] + \<br>           <span class="hljs-number">0.1</span><span class="hljs-number">14</span> * rgb<span class="hljs-number">_</span>array[..., <span class="hljs-number">2</span>]<br></code></pre></td></tr></table></figure><h4 id="Java示例（OpenCV）"><a href="#Java示例（OpenCV）" class="headerlink" title="Java示例（OpenCV）"></a><strong>Java示例（OpenCV）</strong></h4><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs stata">Javapublic static <span class="hljs-keyword">Mat</span> calculateLuminance(<span class="hljs-keyword">Mat</span> rgbMat) &#123;<br>    <span class="hljs-keyword">List</span>&lt;<span class="hljs-keyword">Mat</span>&gt; channels = new ArrayList&lt;&gt;();<br>    Core.<span class="hljs-keyword">split</span>(rgbMat, channels);<br>    <br>    <span class="hljs-keyword">Mat</span> luminance = new <span class="hljs-keyword">Mat</span>();<br>    Core.addWeighted(channels.<span class="hljs-built_in">get</span>(0), 0.299, channels.<span class="hljs-built_in">get</span>(1), 0.587, 0, luminance);<br>    Core.addWeighted(luminance, 1.0, channels.<span class="hljs-built_in">get</span>(2), 0.114, 0, luminance);<br>    <br>    <span class="hljs-keyword">return</span> luminance;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="4-验证方法"><a href="#4-验证方法" class="headerlink" title="4. 验证方法"></a><strong>4. 验证方法</strong></h3><h4 id="测试案例"><a href="#测试案例" class="headerlink" title="测试案例"></a><strong>测试案例</strong></h4><table><thead><tr><th>输入RGB值</th><th>预期亮度值 (8-bit)</th><th>允许误差</th></tr></thead><tbody><tr><td>(255, 255, 255)</td><td>255</td><td>±0.5</td></tr><tr><td>(0, 0, 0)</td><td>0</td><td>±0.5</td></tr><tr><td>(255, 0, 0)</td><td>76.245 → 76</td><td>±1</td></tr><tr><td>(0, 255, 0)</td><td>150.045 → 150</td><td>±1</td></tr></tbody></table><h4 id="Photoshop验证步骤"><a href="#Photoshop验证步骤" class="headerlink" title="Photoshop验证步骤"></a><strong>Photoshop验证步骤</strong></h4><ol><li>在Photoshop中打开测试图像</li><li>使用 <code>图像 → 计算</code> 功能生成亮度通道</li><li>使用取色器对比计算结果</li></ol><h3 id="5-与其他标准的对比"><a href="#5-与其他标准的对比" class="headerlink" title="5. 与其他标准的对比"></a><strong>5. 与其他标准的对比</strong></h3><table><thead><tr><th>标准</th><th>亮度公式</th><th>应用场景</th></tr></thead><tbody><tr><td>ITU-R BT.601</td><td>Y &#x3D; 0.299R + 0.587G + 0.114B</td><td>SDTV标清电视</td></tr><tr><td>ITU-R BT.709</td><td>Y &#x3D; 0.2126R + 0.7152G + 0.0722B</td><td>HDTV高清电视</td></tr><tr><td>CIE 1931</td><td>Y &#x3D; 0.265R + 0.670G + 0.065B</td><td>色彩科学研究</td></tr></tbody></table><h3 id="6-常见问题"><a href="#6-常见问题" class="headerlink" title="6. 常见问题"></a><strong>6. 常见问题</strong></h3><h4 id="Q1：为何不用简单的平均值？"><a href="#Q1：为何不用简单的平均值？" class="headerlink" title="Q1：为何不用简单的平均值？"></a><strong>Q1：为何不用简单的平均值？</strong></h4><ul><li>人眼对颜色的感知非线性，简单的 <code>(R+G+B)/3</code> 会导致亮度失真（例如绿色会显得过暗）</li></ul><h4 id="Q2：如何处理超出范围的亮度值？"><a href="#Q2：如何处理超出范围的亮度值？" class="headerlink" title="Q2：如何处理超出范围的亮度值？"></a><strong>Q2：如何处理超出范围的亮度值？</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># 使用np.clip限制到合法范围</span><br>y = np.clip(y, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>).astype(np.uint8)<br></code></pre></td></tr></table></figure><h4 id="Q3：在低光照条件下的优化方法？"><a href="#Q3：在低光照条件下的优化方法？" class="headerlink" title="Q3：在低光照条件下的优化方法？"></a><strong>Q3：在低光照条件下的优化方法？</strong></h4><ul><li><p>使用伽马校正预处理：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">rgb_array = (rgb_array / <span class="hljs-number">255.0</span>) ** <span class="hljs-number">2.2</span>  <span class="hljs-comment"># 线性化处理</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="7-扩展应用"><a href="#7-扩展应用" class="headerlink" title="7. 扩展应用"></a><strong>7. 扩展应用</strong></h3><h4 id="色度计算（YCbCr转换）"><a href="#色度计算（YCbCr转换）" class="headerlink" title="色度计算（YCbCr转换）"></a><strong>色度计算（YCbCr转换）</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs math">MathCb = 0.564 \cdot (B - Y) + 128 \\<br>Cr = 0.713 \cdot (R - Y) + 128<br></code></pre></td></tr></table></figure><h4 id="灰阶图像生成"><a href="#灰阶图像生成" class="headerlink" title="灰阶图像生成"></a><strong>灰阶图像生成</strong></h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">gray_image = Image.fromarray(Y.astype(np.uint8), mode=<span class="hljs-string">&#x27;L&#x27;</span>)<br></code></pre></td></tr></table></figure><p>该公式是数字图像处理中的核心算法之一，正确理解和实现它对色彩空间转换、图像压缩（如JPEG）和计算机视觉任务至关重要。</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2025/04/02/%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB%E5%88%86%E6%9E%90/"/>
    <url>/2025/04/02/%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB%E5%88%86%E6%9E%90/</url>
    
    <content type="html"><![CDATA[<h1 id="图像亮度分析系统项目手册"><a href="#图像亮度分析系统项目手册" class="headerlink" title="图像亮度分析系统项目手册"></a>图像亮度分析系统项目手册</h1><h2 id="一、项目架构设计"><a href="#一、项目架构设计" class="headerlink" title="一、项目架构设计"></a>一、项目架构设计</h2><p><img src="C:/Users/Administrator/Pictures/image-20250402170422880.png" alt="image-20250402170422880"></p><h2 id="二、核心技术组件分解"><a href="#二、核心技术组件分解" class="headerlink" title="二、核心技术组件分解"></a>二、核心技术组件分解</h2><h3 id="1-核心模块技术矩阵"><a href="#1-核心模块技术矩阵" class="headerlink" title="1. 核心模块技术矩阵"></a>1. 核心模块技术矩阵</h3><table><thead><tr><th>模块名称</th><th>技术组件</th><th>技术原理</th><th>验证方法</th></tr></thead><tbody><tr><td>图像预处理</td><td>PIL&#x2F;Pillow</td><td>基于libjpeg&#x2F;libpng的底层解码，支持8种图像模式转换</td><td>使用Photoshop验证转换准确性</td></tr><tr><td>矩阵运算核心</td><td>Numpy</td><td>基于C语言的ndarray结构，提供矢量化运算能力</td><td>对比纯Python循环运算速度差异</td></tr><tr><td>内存管理</td><td>分块处理算法</td><td>将大矩阵分割为3000x3000子块，控制单次运算内存占用量</td><td>使用memory_profiler监控内存峰值</td></tr><tr><td>数据输出</td><td>Pandas+Openpyxl</td><td>基于xlrd&#x2F;xlwt的Excel读写引擎，支持百万级数据导出</td><td>验证10万x10万矩阵导出完整性</td></tr></tbody></table><h3 id="2-亮度计算算法验证"><a href="#2-亮度计算算法验证" class="headerlink" title="2. 亮度计算算法验证"></a>2. 亮度计算算法验证</h3><h4 id="ITU-R-BT-709公式实现"><a href="#ITU-R-BT-709公式实现" class="headerlink" title="ITU-R BT.709公式实现"></a>ITU-R BT.709公式实现</h4><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Python</span><br><br><span class="hljs-attribute">Y</span> = <span class="hljs-number">0</span>.<span class="hljs-number">299</span>*R + <span class="hljs-number">0</span>.<span class="hljs-number">587</span>*G + <span class="hljs-number">0</span>.<span class="hljs-number">114</span>*B<br></code></pre></td></tr></table></figure><p><strong>验证方法</strong>：</p><ol><li><p>使用Photoshop CC 2023的”计算”功能生成亮度通道</p><p>随机采样100个像素点对比误差值</p></li><li><p>允许误差范围：±0.5%（8位色深）</p></li></ol><p><strong>验证数据</strong>：</p><table><thead><tr><th>测试图像</th><th>最大误差值</th><th>平均误差</th><th>合格率</th></tr></thead><tbody><tr><td>sRGB测试图</td><td>0.43%</td><td>0.12%</td><td>100%</td></tr><tr><td>AdobeRGB测试图</td><td>0.49%</td><td>0.18%</td><td>100%</td></tr></tbody></table><h2 id="三、开发实施流程"><a href="#三、开发实施流程" class="headerlink" title="三、开发实施流程"></a>三、开发实施流程</h2><h3 id="1-环境搭建（Day-1）"><a href="#1-环境搭建（Day-1）" class="headerlink" title="1. 环境搭建（Day 1）"></a>1. 环境搭建（Day 1）</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cmake">Bash<span class="hljs-comment"># 创建隔离环境</span><br>python -m venv img-env<br><br><span class="hljs-comment"># 安装核心依赖</span><br>pip <span class="hljs-keyword">install</span> pillow numpy pandas openpyxl memory-profiler<br><br><span class="hljs-comment"># 验证安装</span><br>python -c <span class="hljs-string">&quot;from PIL import Image; print(Image.__version__)&quot;</span><br></code></pre></td></tr></table></figure><h3 id="2-模块化开发流程"><a href="#2-模块化开发流程" class="headerlink" title="2. 模块化开发流程"></a>2. 模块化开发流程</h3><h4 id="阶段1：图像处理模块（Day-2-3）"><a href="#阶段1：图像处理模块（Day-2-3）" class="headerlink" title="阶段1：图像处理模块（Day 2-3）"></a>阶段1：图像处理模块（Day 2-3）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">Pythonclass ImageProcessor:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, path</span>):<br>        <span class="hljs-variable language_">self</span>.img = Image.<span class="hljs-built_in">open</span>(path)<br>        <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">convert_mode</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;实现CMYK到RGB的精准转换&quot;&quot;&quot;</span><br>        <span class="hljs-keyword">if</span> <span class="hljs-variable language_">self</span>.img.mode == <span class="hljs-string">&#x27;CMYK&#x27;</span>:<br>            <span class="hljs-keyword">return</span> <span class="hljs-variable language_">self</span>.img.convert(<span class="hljs-string">&#x27;RGB&#x27;</span>, matrix=(<br>                (<span class="hljs-number">1.402</span>, -<span class="hljs-number">0.714</span>, <span class="hljs-number">0.0</span>),<br>                (-<span class="hljs-number">0.714</span>, <span class="hljs-number">1.772</span>, <span class="hljs-number">0.0</span>),<br>                (<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>, <span class="hljs-number">1.0</span>)<br>            ))<br></code></pre></td></tr></table></figure><h4 id="阶段2：核心算法开发（Day-4-6）"><a href="#阶段2：核心算法开发（Day-4-6）" class="headerlink" title="阶段2：核心算法开发（Day 4-6）"></a>阶段2：核心算法开发（Day 4-6）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs python">Pythondef benchmark(func):<br>    <span class="hljs-string">&quot;&quot;&quot;性能测试装饰器&quot;&quot;&quot;</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">wrapper</span>(<span class="hljs-params">*args</span>):<br>        start = time.perf_counter()<br>        result = func(*args)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;执行耗时: <span class="hljs-subst">&#123;time.perf_counter()-start:<span class="hljs-number">.2</span>f&#125;</span>s&quot;</span>)<br>        <span class="hljs-keyword">return</span> result<br>    <span class="hljs-keyword">return</span> wrapper<br><br><span class="hljs-meta">@benchmark</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">calculate_brightness</span>(<span class="hljs-params">img_array</span>):<br>    <span class="hljs-comment"># 分块计算实现...</span><br></code></pre></td></tr></table></figure><h4 id="阶段3：数据输出优化（Day-7）"><a href="#阶段3：数据输出优化（Day-7）" class="headerlink" title="阶段3：数据输出优化（Day 7）"></a>阶段3：数据输出优化（Day 7）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs python">Pythonclass ExcelWriter:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, matrix</span>):<br>        <span class="hljs-variable language_">self</span>.df = pd.DataFrame(matrix)<br>        <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">add_headers</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;生成带坐标系的表格结构&quot;&quot;&quot;</span><br>        <span class="hljs-variable language_">self</span>.df.columns = [<span class="hljs-string">f&quot;X<span class="hljs-subst">&#123;i+<span class="hljs-number">1</span>&#125;</span>&quot;</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.df.shape[<span class="hljs-number">1</span>])]<br>        <span class="hljs-variable language_">self</span>.df.index = [<span class="hljs-string">f&quot;Y<span class="hljs-subst">&#123;i+<span class="hljs-number">1</span>&#125;</span>&quot;</span> <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-variable language_">self</span>.df.shape[<span class="hljs-number">0</span>])]<br></code></pre></td></tr></table></figure><h3 id="3-质量保障方案"><a href="#3-质量保障方案" class="headerlink" title="3. 质量保障方案"></a>3. 质量保障方案</h3><h4 id="测试用例设计"><a href="#测试用例设计" class="headerlink" title="测试用例设计"></a>测试用例设计</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs python">Pythonimport unittest<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestBrightness</span>(unittest.TestCase):<br><span class="hljs-meta">    @classmethod</span><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">setUpClass</span>(<span class="hljs-params">cls</span>):<br>        cls.test_img = np.random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">255</span>,(<span class="hljs-number">5000</span>,<span class="hljs-number">5000</span>,<span class="hljs-number">3</span>), dtype=np.uint8)<br>        <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">test_memory_usage</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-string">&quot;&quot;&quot;内存峰值测试&quot;&quot;&quot;</span><br>        tracemalloc.start()<br>        calculate_brightness(<span class="hljs-variable language_">self</span>.test_img)<br>        current, peak = tracemalloc.get_traced_memory()<br>        <span class="hljs-variable language_">self</span>.assertLess(peak, <span class="hljs-number">500</span>*<span class="hljs-number">1024</span>*<span class="hljs-number">1024</span>)  <span class="hljs-comment"># 500MB阈值</span><br></code></pre></td></tr></table></figure><h4 id="性能测试数据"><a href="#性能测试数据" class="headerlink" title="性能测试数据"></a>性能测试数据</h4><table><thead><tr><th>图像尺寸</th><th>处理时间</th><th>内存峰值</th><th>分块策略</th></tr></thead><tbody><tr><td>10000x10000</td><td>58s</td><td>420MB</td><td>3000x3000分块</td></tr><tr><td>20000x20000</td><td>220s</td><td>450MB</td><td>3000x3000分块</td></tr><tr><td>50000x50000</td><td>内存溢出</td><td>–</td><td>需要调整分块策略</td></tr></tbody></table><h2 id="四、生产环境部署"><a href="#四、生产环境部署" class="headerlink" title="四、生产环境部署"></a>四、生产环境部署</h2><h3 id="1-性能优化建议"><a href="#1-性能优化建议" class="headerlink" title="1. 性能优化建议"></a>1. 性能优化建议</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">Python<span class="hljs-comment"># 启用多线程处理（需改造分块算法）</span><br><span class="hljs-keyword">from</span> concurrent.futures <span class="hljs-keyword">import</span> ThreadPoolExecutor<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">parallel_process</span>(<span class="hljs-params">img_array</span>):<br>    <span class="hljs-keyword">with</span> ThreadPoolExecutor(max_workers=<span class="hljs-number">4</span>) <span class="hljs-keyword">as</span> executor:<br>        futures = []<br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, h, chunk_size):<br>            <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, w, chunk_size):<br>                futures.append(executor.submit(process_chunk, i, j))<br>        <span class="hljs-comment"># 合并处理结果...</span><br></code></pre></td></tr></table></figure><h3 id="2-异常处理机制"><a href="#2-异常处理机制" class="headerlink" title="2. 异常处理机制"></a>2. 异常处理机制</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python">Pythonclass ImageProcessingError(Exception):<br>    <span class="hljs-string">&quot;&quot;&quot;自定义异常类型&quot;&quot;&quot;</span><br>    <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">image_to_brightness_matrix</span>(<span class="hljs-params">image_path</span>):<br>    <span class="hljs-keyword">try</span>:<br>        img = Image.<span class="hljs-built_in">open</span>(image_path)<br>    <span class="hljs-keyword">except</span> IOError <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">raise</span> ImageProcessingError(<span class="hljs-string">f&quot;文件损坏: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span>)<br>    <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> e:<br>        <span class="hljs-keyword">raise</span> ImageProcessingError(<span class="hljs-string">f&quot;未知错误: <span class="hljs-subst">&#123;<span class="hljs-built_in">str</span>(e)&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><h2 id="五、扩展开发方向"><a href="#五、扩展开发方向" class="headerlink" title="五、扩展开发方向"></a>五、扩展开发方向</h2><h3 id="技术演进路线"><a href="#技术演进路线" class="headerlink" title="技术演进路线"></a>技术演进路线</h3><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">Mermaid</span><br></code></pre></td></tr></table></figure><h3 id="1-分布式计算方案"><a href="#1-分布式计算方案" class="headerlink" title="1. 分布式计算方案"></a>1. 分布式计算方案</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs python">Python<span class="hljs-comment"># 使用Dask实现分布式处理</span><br><span class="hljs-keyword">import</span> dask.array <span class="hljs-keyword">as</span> da<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">distributed_process</span>(<span class="hljs-params">img_array</span>):<br>    dask_array = da.from_array(img_array, chunks=(<span class="hljs-number">3000</span>, <span class="hljs-number">3000</span>, <span class="hljs-number">3</span>))<br>    <span class="hljs-keyword">return</span> dask_array.map_blocks(<br>        <span class="hljs-keyword">lambda</span> x: <span class="hljs-number">0.299</span>*x[:,:,<span class="hljs-number">0</span>] + <span class="hljs-number">0.587</span>*x[:,:,<span class="hljs-number">1</span>] + <span class="hljs-number">0.114</span>*x[:,:,<span class="hljs-number">2</span>],<br>        dtype=np.float32<br>    )<br></code></pre></td></tr></table></figure><h2 id="附录：参考标准"><a href="#附录：参考标准" class="headerlink" title="附录：参考标准"></a>附录：参考标准</h2><ol><li><strong>色彩空间标准</strong> ITU-R BT.709-6 电视节目制作国际标准</li><li><strong>性能测试标准</strong> ISO&#x2F;IEC 25010 系统与软件质量要求</li><li><strong>开发规范</strong> PEP 8 Python代码风格指南</li><li><strong>测试标准</strong> IEEE 829-2008 软件测试文档标准</li></ol><p>项目文件结构：</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cmake"> <span class="hljs-keyword">project</span>-root/<br>├── docs/                <span class="hljs-comment"># 文档目录</span><br>├── src/                 <span class="hljs-comment"># 源代码</span><br>│   ├── core/            <span class="hljs-comment"># 核心算法</span><br>│   └── utils/           <span class="hljs-comment"># 工具模块</span><br>├── tests/               <span class="hljs-comment"># 测试用例</span><br>└── requirements.txt     <span class="hljs-comment"># 依赖清单</span><br></code></pre></td></tr></table></figure><p>生成HTML文档命令：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">Bashpandoc MANUAL<span class="hljs-selector-class">.md</span> -o MANUAL<span class="hljs-selector-class">.html</span> \<br><span class="hljs-attr">--css</span>=https:<span class="hljs-comment">//cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.2.0/github-markdown.min.css \</span><br><span class="hljs-attr">--toc</span> <span class="hljs-attr">--metadata</span> title=<span class="hljs-string">&quot;图像分析系统手册&quot;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Solon</title>
    <link href="/2025/03/12/%E5%BC%80%E7%BB%83%E9%A2%98%E5%BA%93/"/>
    <url>/2025/03/12/%E5%BC%80%E7%BB%83%E9%A2%98%E5%BA%93/</url>
    
    <content type="html"><![CDATA[<h1 id="Solon框架"><a href="#Solon框架" class="headerlink" title="Solon框架"></a>Solon框架</h1><h2 id="一、新人报道"><a href="#一、新人报道" class="headerlink" title="一、新人报道"></a>一、新人报道</h2><p>Solon 是一个轻量级、高性能的 Java 应用开发框架，专为简化现代云原生和微服务架构而设计。它结合了简洁的核心与模块化扩展机制，适合构建高效、灵活的企业级应用。以下是其核心要点：</p><h3 id="核心特性"><a href="#核心特性" class="headerlink" title="核心特性"></a>核心特性</h3><ol><li><strong>轻量高效</strong><ul><li>核心仅约 0.1MB，启动快（通常在 0.1-0.2 秒内），内存占用低，适合资源敏感场景。</li></ul></li><li><strong>模块化设计</strong><ul><li>提供按需组合的功能模块（如 Web、数据、任务等），避免冗余依赖，保持应用精简。</li></ul></li><li><strong>多样化编程模型</strong><ul><li>支持 Web、Data、Job、Cloud、RPC 等多种开发模式，适配 REST API、微服务、数据驱动等场景。</li></ul></li><li><strong>云原生友好</strong><ul><li>内置服务发现、配置中心等微服务支持，与 Docker&#x2F;K8s 天然契合，适合云环境部署。</li></ul></li></ol><h3 id="功能模块"><a href="#功能模块" class="headerlink" title="功能模块"></a>功能模块</h3><ul><li><strong>Solon Core</strong>：核心容器，提供依赖注入与AOP支持。</li><li><strong>Solon Web</strong>：处理HTTP请求，支持REST、MVC、WebSocket。</li><li><strong>Solon Cloud</strong>：集成服务治理、配置管理等微服务组件。</li><li><strong>Solon Boot</strong>：简化项目初始化，支持快速构建独立应用。</li><li><strong>插件生态</strong>：通过插件扩展缓存、分布式事务等功能。</li></ul><h3 id="与-Spring-对比"><a href="#与-Spring-对比" class="headerlink" title="与 Spring 对比"></a>与 Spring 对比</h3><ul><li><strong>更轻量</strong>：无强制依赖，启动速度显著快于 Spring Boot。</li><li><strong>兼容 Spring</strong>：支持部分 Spring 注解，便于项目迁移或混合使用。</li><li><strong>低学习成本</strong>：设计理念类似 Spring，但更强调简洁与性能。</li></ul><h3 id="适用场景"><a href="#适用场景" class="headerlink" title="适用场景"></a>适用场景</h3><ul><li>微服务架构中的轻量级服务模块。</li><li>云原生应用，尤其是资源受限的容器化环境。</li><li>中小型项目，需快速启动和高效运行。</li><li>IoT或边缘计算场景，要求低内存消耗。</li></ul><h2 id="二、新品尝鲜"><a href="#二、新品尝鲜" class="headerlink" title="二、新品尝鲜"></a>二、新品尝鲜</h2><h3 id="1、创建Solon项目"><a href="#1、创建Solon项目" class="headerlink" title="1、创建Solon项目"></a>1、创建Solon项目</h3><ul><li>创建maven项目</li></ul><p><img src="C:/Users/Administrator/AppData/Roaming/Typora/typora-user-images/image-20250312215011420.png" alt="image-20250312215011420"></p>]]></content>
    
    
    <categories>
      
      <category>Java框架</category>
      
    </categories>
    
    
    <tags>
      
      <tag>自我提升</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>WIndows搭建单节点Minio</title>
    <link href="/2024/12/31/WIndows%E6%90%AD%E5%BB%BA%E5%8D%95%E8%8A%82%E7%82%B9Minio/"/>
    <url>/2024/12/31/WIndows%E6%90%AD%E5%BB%BA%E5%8D%95%E8%8A%82%E7%82%B9Minio/</url>
    
    <content type="html"><![CDATA[<h1 id="布署单节点单磁盘的MinIO服务"><a href="#布署单节点单磁盘的MinIO服务" class="headerlink" title="布署单节点单磁盘的MinIO服务"></a>布署单节点单磁盘的MinIO服务</h1><p>以下流程部署了由单个MinIO服务器和单个驱动器或存储卷组成的MinIO。</p><blockquote><p>网络文件系统卷打破一致性保证</p><p>MinIO强制实施 <strong>写入后读取</strong> 和 <strong>写入后列举</strong> 的一致性模型， 需要本地驱动器文件系统。如果底层存储卷是NFS或类似的网络附加存储卷， MinIO无法提供一致性保证。</p></blockquote><h2 id="1、下载MinIO服务器文件"><a href="#1、下载MinIO服务器文件" class="headerlink" title="1、下载MinIO服务器文件"></a>1、下载MinIO服务器文件</h2><p>从以下URL下载MinIO可执行文件：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">https:<span class="hljs-regexp">//</span>dl.minio.org.cn<span class="hljs-regexp">/server/mi</span>nio<span class="hljs-regexp">/release/</span>windows-amd64/minio.exe<br></code></pre></td></tr></table></figure><p>下一步是运行可执行文件的指令。 无法通过资源管理器或双击文件来运行可执行文件。 相反，你需要调用可执行文件来启动服务器。</p><h2 id="2、为-MinIO-准备数据路径"><a href="#2、为-MinIO-准备数据路径" class="headerlink" title="2、为 MinIO 准备数据路径"></a>2、为 MinIO 准备数据路径</h2><p>确保数据路径为空，且不包含任何现有文件，包括隐藏或Windows系统文件。</p><p>如果指定了一个不为MinIO专用的驱动器，考虑创建一个专用于存储MinIO数据的专用文件夹，例如 <code>D:/Minio</code>。</p><h2 id="3、启动-MinIO-服务器"><a href="#3、启动-MinIO-服务器" class="headerlink" title="3、启动 MinIO 服务器"></a>3、启动 MinIO 服务器</h2><p>打开命令提示符或PowerShell，并执行以下命令来在该会话中启动MinIO SNSD 部署：</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">minio server D:<span class="hljs-string">/minio</span> <span class="hljs-params">--console-address</span> <span class="hljs-string">&quot;:9001&quot;</span><br></code></pre></td></tr></table></figure><p>输出应类似于以下内容：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">PS</span> D:\GPT浏览器下载&gt; .\minio.exe server D:/minio <span class="hljs-literal">--console-address</span> <span class="hljs-string">&quot;:9001&quot;</span>                                           INFO: Formatting <span class="hljs-number">1</span>st pool, <span class="hljs-number">1</span> <span class="hljs-built_in">set</span>(s), <span class="hljs-number">1</span> drives per <span class="hljs-built_in">set</span>.                                                                  <br>INFO: WARNING: Host local has more than <span class="hljs-number">0</span> drives of <span class="hljs-built_in">set</span>. A host failure will result <span class="hljs-keyword">in</span> <span class="hljs-keyword">data</span> becoming unavailable.       <br>MinIO Object Storage Server                                                                                             <br>Copyright: <span class="hljs-number">2015</span><span class="hljs-literal">-2024</span> MinIO, Inc.                                                                                        <br>License: GNU AGPLv3 - https://www.gnu.org/licenses/agpl<span class="hljs-literal">-3</span>.<span class="hljs-number">0</span>.html                                                       Version: RELEASE.<span class="hljs-number">2024</span><span class="hljs-literal">-12-18T13-15-44Z</span> (go1.<span class="hljs-number">23.4</span> windows/amd64)                                                                                                                                                                                  <br>API: http://<span class="hljs-number">192.168</span>.<span class="hljs-number">10.220</span>:<span class="hljs-number">9000</span>  http://<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">9000</span>                                                                     RootUser: minioadmin                                                                                                    <br>RootPass: minioadmin                                                                                                                                                                                                                  <br>WebUI: http://<span class="hljs-number">192.168</span>.<span class="hljs-number">10.220</span>:<span class="hljs-number">9001</span> http://<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">9001</span>                                                                   RootUser: minioadmin                                                                                                    <br>RootPass: minioadmin                                                                                                                                                                                                                         <br><span class="hljs-built_in">CLI</span>: https://min.io/docs/minio/linux/reference/minio<span class="hljs-literal">-mc</span>.html<span class="hljs-comment">#quickstart $ mc alias set &#x27;myminio&#x27; &#x27;http://192.168.10.220:9000&#x27; &#x27;minioadmin&#x27; &#x27;minioadmin&#x27;                                                                                                                                                              </span><br>Docs: https://docs.min.io                                                                                               <br>WARN: Detected default credentials <span class="hljs-string">&#x27;minioadmin:minioadmin&#x27;</span>, we recommend that you change these values with <span class="hljs-string">&#x27;MINIO_ROOT_USER&#x27;</span> and <span class="hljs-string">&#x27;MINIO_ROOT_PASSWORD&#x27;</span> environment variables  <br></code></pre></td></tr></table></figure><h2 id="4、连接到-MinIO-服务器"><a href="#4、连接到-MinIO-服务器" class="headerlink" title="4、连接到 MinIO 服务器"></a>4、连接到 MinIO 服务器</h2><p>您可以通过在首选的浏览器中输入MinIO服务器 <code>Console控制台</code> 中的任何主机名或IP地址来访问MinIO控制台，例如<a href="http://localhost:9001。">http://localhost:9001。</a></p><p>登录MinIO的用户名和密码配置参数为 <code>MINIO_ROOT_USER</code> 和 <code>MINIO_ROOT_PASSWORD</code> 这些配置可以在在容器指定的环境文件中进行修改。</p><p><img src="https://cdn.jsdelivr.net/gh/awk001/hexo_pic/202501010004414.png" alt="访问页面"></p><p>您可以使用MinIO控制台进行一般管理任务，如身份和访问管理、指标和日志监控或服务器配置。每个MinIO服务器都包含其自己的嵌入式MinIO控制台。 如果您的本地主机防火墙允许外部访问控制台端口，则同一网络上的其他主机可以使用您的本地主机的IP地址或主机名访问控制台。</p>]]></content>
    
    
    <categories>
      
      <category>技术基础</category>
      
    </categories>
    
    
    <tags>
      
      <tag>程序员必备</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>英语语法</title>
    <link href="/2024/11/07/%E8%8B%B1%E8%AF%AD/"/>
    <url>/2024/11/07/%E8%8B%B1%E8%AF%AD/</url>
    
    <content type="html"><![CDATA[<h2 id="英语语法"><a href="#英语语法" class="headerlink" title="英语语法"></a>英语语法</h2><h3 id="一、动词"><a href="#一、动词" class="headerlink" title="一、动词"></a>一、动词</h3><h4 id="实义动词"><a href="#实义动词" class="headerlink" title="实义动词"></a>实义动词</h4><p>及物动词（vt.）必须跟宾语；不及物动词（vi.）需要加介词后跟宾语</p><p>系动词：无实际意义，连接主语和表语</p><table><thead><tr><th>类型</th><th>单词</th></tr></thead><tbody><tr><td>表状态</td><td>be</td></tr><tr><td>感官动词</td><td>look , smell , taste , sound , feel</td></tr><tr><td>表变化</td><td>become , get , turn , grow , fall</td></tr><tr><td>表保持</td><td>keep , stay , remain , stand</td></tr><tr><td>表表象</td><td>seem ， appear</td></tr><tr><td>表终止或结果</td><td>prove</td></tr></tbody></table><h4 id="助动词"><a href="#助动词" class="headerlink" title="助动词"></a>助动词</h4><p>构成疑问、否定、时态和语态</p><ul><li>be</li><li>do &#x2F; did &#x2F; does</li><li>Have &#x2F; has</li><li>will</li></ul><h4 id="情态动词"><a href="#情态动词" class="headerlink" title="情态动词"></a>情态动词</h4><ol><li>表示说话人的主观态度</li><li>与实义动词&#x2F;系动词一起构成谓语</li></ol><table><thead><tr><th>单词</th><th>含义</th></tr></thead><tbody><tr><td>Can &#x2F; could</td><td>能够，会，可以，可能</td></tr><tr><td>May &#x2F; might</td><td>许可，可能性</td></tr><tr><td>Must &#x2F; have to</td><td>必须，不得不</td></tr><tr><td>Should &#x2F; ought to</td><td>应该</td></tr><tr><td>Would</td><td>将会，想要</td></tr><tr><td>need</td><td>需要</td></tr><tr><td>dare</td><td>敢</td></tr></tbody></table>]]></content>
    
    
    <categories>
      
      <category>课程学习</category>
      
    </categories>
    
    
    <tags>
      
      <tag>自我提升</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Redis基于Windows系统的安装</title>
    <link href="/2024/10/27/Redis%E5%9F%BA%E4%BA%8EWindows%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AE%89%E8%A3%85/"/>
    <url>/2024/10/27/Redis%E5%9F%BA%E4%BA%8EWindows%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AE%89%E8%A3%85/</url>
    
    <content type="html"><![CDATA[<h2 id="一、Redis的下载"><a href="#一、Redis的下载" class="headerlink" title="一、Redis的下载"></a>一、Redis的下载</h2><p>Redis官网并不支持Windows格式下载所以我们去github上下载</p><p>链接：<a href="https://github.com/MSOpenTech/redis/releases">https://github.com/MSOpenTech/redis/releases</a></p><p><img src="https://cdn.jsdelivr.net/gh/awk001/hexo_pic/202410272203125.png" alt="下载地址"></p><h2 id="二、安装Redis"><a href="#二、安装Redis" class="headerlink" title="二、安装Redis"></a>二、安装Redis</h2><ul><li><strong>自定义存放位置</strong>。下载.zip格式的安装包，自定义一个位置，将压缩包的文件解压进去</li></ul><p><img src="https://cdn.jsdelivr.net/gh/awk001/hexo_pic/202410272208333.png" alt="自定义解压位置"></p><ul><li><strong>开启服务</strong>。打开<code>cmd</code>切换到该目录下，执行命令<code>redis-server redis.windows.conf</code>直接使用</li></ul><p><img src="https://cdn.jsdelivr.net/gh/awk001/hexo_pic/202410272211241.png" alt="开启Redis服务"></p><blockquote><p>[!tip]</p><p>注意此时不能关闭cmd窗口、若关闭则Redis也关闭了</p></blockquote><ul><li><strong>尝试客户端连接</strong>。这时候另启一个 cmd 窗口，切换到 redis 目录下运行:</li></ul><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">redis-cli.exe -h <span class="hljs-number">127</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span> -p <span class="hljs-number">6379</span><br></code></pre></td></tr></table></figure><p>设置键值对:</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-built_in">set</span> myKey abc<br></code></pre></td></tr></table></figure><p>取出键值对:</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">get myKey<br></code></pre></td></tr></table></figure><p>退出:</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cmd">shutdown<br><br># 然后按 ctrl + c 就彻底退出了<br></code></pre></td></tr></table></figure><h2 id="三、系统服务加入Redis"><a href="#三、系统服务加入Redis" class="headerlink" title="三、系统服务加入Redis"></a>三、系统服务加入Redis</h2><p>运行命令</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">redis-server.exe --service-install redis.windows.conf --loglevel verbose<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/awk001/hexo_pic/202410272218463.png" alt="redis加入系统服务"></p><p><img src="https://cdn.jsdelivr.net/gh/awk001/hexo_pic/202410272221396.png" alt="服务中加入Redis成功"></p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cmd">#启动服务<br>redis-server --service-<span class="hljs-built_in">start</span><br><br>#停止服务<br>redis-server –service-stop<br><br>#卸载服务<br>redis-server --service-uninstall<br></code></pre></td></tr></table></figure><h2 id="四、密码设置"><a href="#四、密码设置" class="headerlink" title="四、密码设置"></a>四、密码设置</h2><p>redis密码设置有两种方式，一种需要重启redis服务，一种不需要重启redis服务。</p><ul><li><p>需要重启redis服务的设置方式<br>即找到redis的配置文件—redis.conf文件，然后修改里面的requirepass，这个本来是注释起来了的，将注释去掉，并将后面对应的字段设置成自己想要的密码，保存退出。重启redis服务，即可。</p></li><li><p>不需要重启redis服务的密码设置方式<br>这种相对简单，连接redis之后，通过命令设置，如下：</p></li></ul><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cmd">config <span class="hljs-built_in">set</span> requirepass <span class="hljs-number">123456</span><br># 如此，便将密码设置成了<span class="hljs-number">123456</span><br></code></pre></td></tr></table></figure><p>设置之后，可通过以下指令查看密码</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">config get requirepass<br></code></pre></td></tr></table></figure><blockquote><p>[!tip]</p><p>注意：通过命令行修改了密码之后，配置文件的requirepass字段后面的密码是不会随之修改的</p></blockquote><h2 id="附录：Redis配置文件样例"><a href="#附录：Redis配置文件样例" class="headerlink" title="附录：Redis配置文件样例"></a>附录：Redis配置文件样例</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br></pre></td><td class="code"><pre><code class="hljs xml"># Redis配置文件样例<br><br># Note on units: when memory size is needed, it is possible to specifiy<br># it in the usual form of 1k 5GB 4M and so forth:<br>#<br># 1k =&gt; 1000 bytes<br># 1kb =&gt; 1024 bytes<br># 1m =&gt; 1000000 bytes<br># 1mb =&gt; 1024*1024 bytes<br># 1g =&gt; 1000000000 bytes<br># 1gb =&gt; 1024*1024*1024 bytes<br>#<br># units are case insensitive so 1GB 1Gb 1gB are all the same.<br><br># Redis默认不是以守护进程的方式运行，可以通过该配置项修改，使用yes启用守护进程<br># 启用守护进程后，Redis会把pid写到一个pidfile中，在/var/run/redis.pid<br>#是否在后台运行；no：不是后台运行 <br>daemonize yes <br><br>#是否开启保护模式，默认开启。要是配置里没有指定bind和密码。开启该参数后，redis只会本地进行访问，拒绝外部访问。<br> protected-mode yes <br><br>#redis的进程文件 <br>pidfile /var/run/redis/redis-server.pid <br><br>#redis监听的端口号。 <br>port 6379<br><br>#此参数确定了TCP连接中已完成队列(完成三次握手之后)的长度， <br>#当然此值必须不大于Linux系统定义的/proc/sys/net/core/somaxconn值，默认是511，而Linux的默认参数值是128。<br>#当系统并发量大并且客户端速度缓慢的时候，可以将这二个参数一起参考设定。<br>#该内核参数默认值一般是128，对于负载很大的服务程序来说大大的不够。<br>#一般会将它修改为2048或者更大。在/etc/sysctl.conf中添加:net.core.somaxconn = 2048，然后在终端中执行sysctl -p。<br> tcp-backlog 511 <br><br>#指定 redis 只接收来自于该 IP 地址的请求，如果不进行设置，那么将处理所有请求 <br>#bind 127.0.0.1 <br>#bind 0.0.0.0<br> <br>#配置unix socket来让redis支持监听本地连接。 <br># unixsocket /var/run/redis/redis.sock <br><br>#配置unix socket使用文件的权限 <br># unixsocketperm 700<br><br> # 此参数为设置客户端空闲超过timeout，服务端会断开连接，为0则服务端不会主动断开连接，不能小于0。<br> timeout 0 <br><br>#tcp keepalive参数。如果设置不为0，就使用配置tcp的SO_KEEPALIVE值，<br>#使用keepalive有两个好处:检测挂掉的对端。降低中间设备出问题而导致网络看似连接却已经与对端端口的问题。<br>#在Linux内核中，设置了keepalive，redis会定时给对端发送ack。检测到对端关闭需要两倍的设置值。<br> tcp-keepalive 0 <br><br>#指定了服务端日志的级别。<br>#级别包括：debug（很多信息，方便开发、测试），<br>#verbose（许多有用的信息，但是没有debug级别信息多），<br>#notice（适当的日志级别，适合生产环境），<br>#warn（只有非常重要的信息）<br>loglevel notice <br><br>#指定了记录日志的文件。空字符串的话，日志会打印到标准输出设备。后台运行的redis标准输出是/dev/null。 <br>logfile /var/log/redis/redis-server.log <br><br>#是否打开记录syslog功能 <br># syslog-enabled no <br><br>#syslog的标识符。 <br># syslog-ident redis <br><br>#日志的来源、设备 #<br>syslog-facility local0 <br><br>#数据库的数量，默认使用的数据库是DB 0。<br>#可以通过SELECT命令选择一个<br>db databases 16 <br><br># redis是基于内存的数据库，可以通过设置该值定期写入磁盘。 <br># 注释掉“save”这一行配置项就可以让保存数据库功能失效 <br># 900秒（15分钟）内至少1个key值改变（则进行数据库保存--持久化）<br> # 300秒（5分钟）内至少10个key值改变（则进行数据库保存--持久化） <br># 60秒（1分钟）内至少10000个key值改变（则进行数据库保存--持久化） <br>save 900 1 <br>save 300 10 <br>save 60 10000 <br><br>#当RDB持久化出现错误后，是否依然进行继续进行工作，<br>#yes：不能进行工作，no：可以继续进行工作，<br>#可以通过info中的rdb_last_bgsave_status了解RDB持久化是否有错误 <br>stop-writes-on-bgsave-error yes <br><br>#使用压缩rdb文件，rdb文件压缩使用LZF压缩算法，<br>#yes：压缩，但是需要一些cpu的消耗。no：不压缩，需要更多的磁盘空间 <br>rdbcompression yes <br><br>#是否校验rdb文件。<br>#从rdb格式的第五个版本开始，在rdb文件的末尾会带上CRC64的校验和。这跟有利于文件的容错性，但是在保存rdb文件的时候，会有大概10%的性能损耗，所以如果你追求高性能，可以关闭该配置。 <br>rdbchecksum yes <br><br>#rdb文件的名称 <br>dbfilename dump.rdb <br><br>#数据目录，数据库的写入会在这个目录。<br>#rdb、aof文件也会写在这个目录 <br>dir /data<br><br>############### 主从复制 ############### <br><br>#复制选项，slave复制对应的master。 <br># slaveof <span class="hljs-tag">&lt;<span class="hljs-name">masterip</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">masterport</span>&gt;</span><br><br>#如果master设置了requirepass，那么slave要连上master，需要有master的密码才行。masterauth就是用来配置master的密码，这样可以在连上master后进行认证。 <br># masterauth <span class="hljs-tag">&lt;<span class="hljs-name">master-password</span>&gt;</span><br><br>#当从库同主机失去连接或者复制正在进行，从机库有两种运行方式：<br>#1) 如果slave-serve-stale-data设置为yes(默认设置)，从库会继续响应客户端的请求。<br>#2) 如果slave-serve-stale-data设置为no，<br>#除去INFO和SLAVOF命令之外的任何请求都会返回一个错误”SYNC with master in progress”。 <br>slave-serve-stale-data yes <br><br>#作为从服务器，默认情况下是只读的（yes），可以修改成NO，用于写（不建议）。 <br>slave-read-only yes <br><br>#是否使用socket方式复制数据。<br>#目前redis复制提供两种方式，disk和socket。<br>#如果新的slave连上来或者重连的slave无法部分同步，就会执行全量同步，master会生成rdb文件。<br>#有2种方式：<br>#disk方式是master创建一个新的进程把rdb文件保存到磁盘，再把磁盘上的rdb文件传递给slave。<br>#socket是master创建一个新的进程，直接把rdb文件以socket的方式发给slave。<br>#disk方式的时候，当一个rdb保存的过程中，多个slave都能共享这个rdb文件。<br>#socket的方式就的一个个slave顺序复制。在磁盘速度缓慢，网速快的情况下推荐用socket方式。 <br>repl-diskless-sync no <br><br>#diskless复制的延迟时间，防止设置为0。<br>#一旦复制开始，节点不会再接收新slave的复制请求直到下一个rdb传输。<br>#所以最好等待一段时间，等更多的slave连上来。 <br>repl-diskless-sync-delay 5 <br><br>#slave根据指定的时间间隔向服务器发送ping请求。<br>#时间间隔可以通过 repl_ping_slave_period 来设置，默认10秒。 <br># repl-ping-slave-period 10 <br><br>#复制连接超时时间。<br>#master和slave都有超时时间的设置。master检测到slave上次发送的时间超过repl-timeout，即认为slave离线，清除该slave信息。<br>#slave检测到上次和master交互的时间超过repl-timeout，则认为master离线。<br>#需要注意的是repl-timeout需要设置一个比repl-ping-slave-period更大的值，不然会经常检测到超时。<br> # repl-timeout 60 <br><br>#是否禁止复制tcp链接的tcp <br>#nodelay参数，可传递yes或者no。默认是no，即使用tcp nodelay。<br>#如果master设置了yes来禁止tcp nodelay设置，在把数据复制给slave的时候，会减少包的数量和更小的网络带宽。但是这也可能带来数据的延迟。<br>#默认我们推荐更小的延迟，但是在数据量传输很大的场景下，建议选择yes。 <br>repl-disable-tcp-nodelay no <br><br>#复制缓冲区大小，<br>#这是一个环形复制缓冲区，用来保存最新复制的命令。<br>#这样在slave离线的时候，不需要完全复制master的数据，<br>#如果可以执行部分同步，只需要把缓冲区的部分数据复制给slave，就能恢复正常复制状态。<br>#缓冲区的大小越大，slave离线的时间可以更长，复制缓冲区只有在有slave连接的时候才分配内存。<br>#没有slave的一段时间，内存会被释放出来，默认1m。 <br># repl-backlog-size 5mb <br><br>#master没有slave一段时间会释放复制缓冲区的内存，<br>#repl-backlog-ttl用来设置该时间长度。单位为秒。 <br># repl-backlog-ttl 3600 <br><br>#当master不可用，Sentinel会根据slave的优先级选举一个master。<br>#最低的优先级的slave，当选master。而配置成0，永远不会被选举。 <br>slave-priority 100 <br><br>#redis提供了可以让master停止写入的方式，<br>#如果配置了min-slaves-to-write，健康的slave的个数小于N，mater就禁止写入。<br>#master最少得有多少个健康的slave存活才能执行写命令。<br>#这个配置虽然不能保证N个slave都一定能接收到master的写操作，但是能避免没有足够健康的slave的时候，master不能写入来避免数据丢失。<br>#设置为0是关闭该功能。 <br># min-slaves-to-write 3 <br><br>#延迟小于min-slaves-max-lag秒的slave才认为是健康的slave。<br> # min-slaves-max-lag 10 <br><br># 设置1或另一个设置为0禁用这个特性。 <br># Setting one or the other to 0 disables the feature. <br># By default min-slaves-to-write is set to 0 (feature disabled) and <br># min-slaves-max-lag is set to 10.<br><br> ############### 安全相关 ############### <br><br>#requirepass配置可以让用户使用AUTH命令来认证密码，才能使用其他命令。<br>#这让redis可以使用在不受信任的网络中。为了保持向后的兼容性，可以注释该命令，因为大部分用户也不需要认证。<br>#使用requirepass的时候需要注意，因为redis太快了，每秒可以认证15w次密码，简单的密码很容易被攻破，所以最好使用一个更复杂的密码。<br>#注意只有密码没有用户名。 <br># requirepass foobared <br><br>#把危险的命令给修改成其他名称。<br>#比如CONFIG命令可以重命名为一个很难被猜到的命令，这样用户不能使用，而内部工具还能接着使用。 <br># rename-command CONFIG b840fc02d524045429941cc15f59e41cb7be6c52 <br><br>#设置成一个空的值，可以禁止一个命令 <br># rename-command CONFIG &quot;&quot; <br><br>############### 进程限制相关 ############### <br><br># 设置能连上redis的最大客户端连接数量。默认是10000个客户端连接。<br>#由于redis不区分连接是客户端连接还是内部打开文件或者和slave连接等，所以maxclients最小建议设置到32。<br>#如果超过了maxclients，redis会给新的连接发送’max number of clients reached’，并关闭连接。 <br># maxclients 10000<br><br>#redis配置的最大内存容量。当内存满了，需要配合maxmemory-policy策略进行处理。<br>#注意slave的输出缓冲区是不计算在maxmemory内的。<br>#所以为了防止主机内存使用完，建议设置的maxmemory需要更小一些。<br># maxmemory <span class="hljs-tag">&lt;<span class="hljs-name">bytes</span>&gt;</span><br><br>#内存容量超过maxmemory后的处理策略。 <br>#volatile-lru：利用LRU算法移除设置过过期时间的key。 <br>#volatile-random：随机移除设置过过期时间的key。 <br>#volatile-ttl：移除即将过期的key，根据最近过期时间来删除（辅以TTL） <br>#allkeys-lru：利用LRU算法移除任何key。 <br>#allkeys-random：随机移除任何key。 <br>#noeviction：不移除任何key，只是返回一个写错误。 <br>#上面的这些驱逐策略，如果redis没有合适的key驱逐，对于写命令，还是会返回错误。<br>#redis将不再接收写请求，只接收get请求。<br>#写命令包括：set setnx setex append incr decr rpush lpush rpushx lpushx linsert lset rpoplpush sadd sinter sinterstore sunion sunionstore sdiff sdiffstore zadd zincrby zunionstore zinterstore hset hsetnx hmset hincrby incrby decrby getset mset msetnx exec sort。 <br># maxmemory-policy noeviction <br><br>#lru检测的样本数。<br>#使用lru或者ttl淘汰算法，从需要淘汰的列表中随机选择sample个key，选出闲置时间最长的key移除。<br> # maxmemory-samples 5 <br><br>############### APPEND ONLY 持久化方式 ############### <br><br>#默认redis使用的是rdb方式持久化，这种方式在许多应用中已经足够用了。<br>#但是redis如果中途宕机，会导致可能有几分钟的数据丢失，根据save来策略进行持久化，Append Only File是另一种持久化方式，可以提供更好的持久化特性。<br>#Redis会把每次写入的数据在接收后都写入 appendonly.aof 文件，每次启动时Redis都会先把这个文件的数据读入内存里，先忽略RDB文件。 <br>appendonly no <br><br>#aof文件名 <br>appendfilename &quot;appendonly.aof&quot; <br><br>#aof持久化策略的配置 <br>#no表示不执行fsync，由操作系统保证数据同步到磁盘，速度最快。 <br>#always表示每次写入都执行fsync，以保证数据同步到磁盘。 <br>#everysec表示每秒执行一次fsync，可能会导致丢失这1s数据。 <br>appendfsync everysec <br><br># 在aof重写或者写入rdb文件的时候，会执行大量IO，<br>#此时对于everysec和always的aof模式来说，执行fsync会造成阻塞过长时间，no-appendfsync-on-rewrite字段设置为默认设置为no，是最安全的方式，不会丢失数据，但是要忍受阻塞的问题。<br>#如果对延迟要求很高的应用，这个字段可以设置为yes，，设置为yes表示rewrite期间对新写操作不fsync,暂时存在内存中,不会造成阻塞的问题（因为没有磁盘竞争），等rewrite完成后再写入，这个时候redis会丢失数据。<br>#Linux的默认fsync策略是30秒。可能丢失30秒数据。<br>#因此，如果应用系统无法忍受延迟，而可以容忍少量的数据丢失，则设置为yes。<br>#如果应用系统无法忍受数据丢失，则设置为no。 <br>no-appendfsync-on-rewrite no <br><br>#aof自动重写配置。<br>#当目前aof文件大小超过上一次重写的aof文件大小的百分之多少进行重写，<br>#即当aof文件增长到一定大小的时候Redis能够调用bgrewriteaof对日志文件进行重写。<br>#当前AOF文件大小是上次日志重写得到AOF文件大小的二倍（设置为100）时，自动启动新的日志重写过程。 <br>auto-aof-rewrite-percentage 100 <br><br>#设置允许重写的最小aof文件大小，避免了达到约定百分比但尺寸仍然很小的情况还要重写 <br>auto-aof-rewrite-min-size 64mb <br><br>#aof文件可能在尾部是不完整的，当redis启动的时候，aof文件的数据被载入内存。<br>#重启可能发生在redis所在的主机操作系统宕机后，尤其在ext4文件系统没有加上data=ordered选项（redis宕机或者异常终止不会造成尾部不完整现象。）出现这种现象，<br>#可以选择让redis退出，或者导入尽可能多的数据。<br>#如果选择的是yes，当截断的aof文件被导入的时候，会自动发布一个log给客户端然后load。<br>#如果是no，用户必须手动redis-check-aof修复AOF文件才可以。 <br>aof-load-truncated yes <br><br>############### LUA SCRIPTING ############### <br><br># 如果达到最大时间限制（毫秒），redis会记个log，然后返回error。<br>#当一个脚本超过了最大时限。只有SCRIPT KILL和SHUTDOWN NOSAVE可以用。<br>#第一个可以杀没有调write命令的东西。要是已经调用了write，只能用第二个命令杀。<br>lua-time-limit 5000 <br><br>############### 集群相关 ############### <br><br>#集群开关，默认是不开启集群模式。 <br># cluster-enabled yes <br><br>#集群配置文件的名称，每个节点都有一个集群相关的配置文件，持久化保存集群的信息。<br>#这个文件并不需要手动配置，这个配置文件有Redis生成并更新，每个Redis集群节点需要一个单独的配置文件，请确保与实例运行的系统中配置文件名称不冲突 <br># cluster-config-file nodes-6379.conf<br><br> #节点互连超时的阀值。集群节点超时毫秒数 <br># cluster-node-timeout 15000 <br><br>#在进行故障转移的时候，全部slave都会请求申请为master，但是有些slave可能与master断开连接一段时间了，导致数据过于陈旧，这样的slave不应该被提升为master。<br>#该参数就是用来判断slave节点与master断线的时间是否过长。<br>#判断方法是： <br>#比较slave断开连接的时间和(node-timeout * slave-validity-factor) + repl-ping-slave-period <br>#如果节点超时时间为三十秒, 并且slave-validity-factor为10,假设默认的repl-ping-slave-period是10秒，即如果超过310秒slave将不会尝试进行故障转移<br> # cluster-slave-validity-factor 10 <br><br>#master的slave数量大于该值，slave才能迁移到其他孤立master上，<br>#如这个参数若被设为2，那么只有当一个主节点拥有2 个可工作的从节点时，它的一个从节点会尝试迁移。 <br># cluster-migration-barrier 1 <br><br>#默认情况下，集群全部的slot有节点负责，集群状态才为ok，才能提供服务。设置为no，可以在slot没有全部分配的时候提供服务。不建议打开该配置。<br> # cluster-require-full-coverage yes <br><br>############### SLOW LOG 慢查询日志 ############### ##<br><br>#slog log是用来记录redis运行中执行比较慢的命令耗时。<br>#当命令的执行超过了指定时间，就记录在slow log中，slog log保存在内存中，所以没有IO操作。<br># #执行时间比slowlog-log-slower-than大的请求记录到slowlog里面，单位是微秒，所以1000000就是1秒。<br>#注意，负数时间会禁用慢查询日志，而0则会强制记录所有命令。 <br>slowlog-log-slower-than 10000 <br><br>#慢查询日志长度。当一个新的命令被写进日志的时候，最老的那个记录会被删掉。<br>#这个长度没有限制。只要有足够的内存就行。<br>#你可以通过 SLOWLOG RESET 来释放内存。 <br>slowlog-max-len 128<br><br> ############### 延迟监控 ############### <br>#延迟监控功能是用来监控redis中执行比较缓慢的一些操作，用LATENCY打印redis实例在跑命令时的耗时图表。<br>#只记录大于等于下边设置的值的操作。0的话，就是关闭监视。默认延迟监控功能是关闭的，<br>#如果你需要打开，也可以通过CONFIG SET命令动态设置。 <br>latency-monitor-threshold 0 <br><br>############### EVENT NOTIFICATION 订阅通知 ############### <br><br>#键空间通知使得客户端可以通过订阅频道或模式，来接收那些以某种方式改动了 Redis 数据集的事件。<br>#因为开启键空间通知功能需要消耗一些 CPU ，所以在默认配置下，该功能处于关闭状态。 <br>#notify-keyspace-events 的参数可以是以下字符的任意组合，<br>#它指定了服务器该发送哪些类型的通知： <br>##K 键空间通知，所有通知以 __keyspace@__ 为前缀 <br>##E 键事件通知，所有通知以 __keyevent@__ 为前缀 <br>##g DEL 、 EXPIRE 、 RENAME 等类型无关的通用命令的通知 <br>##$ 字符串命令的通知 ##l 列表命令的通知 <br>##s 集合命令的通知<br>##h 哈希命令的通知 <br>##z 有序集合命令的通知 <br>##x 过期事件：每当有过期键被删除时发送 <br>##e 驱逐(evict)事件：每当有键因为 maxmemory 政策而被删除时发送 <br>##A 参数 g$lshzxe 的别名 <br>#输入的参数中至少要有一个 K 或者 E，否则的话，不管其余的参数是什么，都不会有任何 通知被分发。详细使用可以参考http://redis.io/topics/notifications <br>notify-keyspace-events &quot;&quot; <br><br>############### ADVANCED CONFIG 高级配置 ############### <br><br>#数据量小于等于hash-max-ziplist-entries的用ziplist，大于hash-max-ziplist-entries用hash <br>hash-max-ziplist-entries 512 <br><br>#value大小小于等于hash-max-ziplist-value的用ziplist，大于hash-max-ziplist-value用hash。 <br>hash-max-ziplist-value 64<br><br>#数据量小于等于list-max-ziplist-entries用ziplist，大于list-max-ziplist-entries用list。 <br>list-max-ziplist-entries 512 <br><br>#value大小小于等于list-max-ziplist-value的用ziplist，大于list-max-ziplist-value用list。<br>list-max-ziplist-value 64 <br><br>#数据量小于等于set-max-intset-entries用iniset，大于set-max-intset-entries用set。 <br>set-max-intset-entries 512 <br><br>#数据量小于等于zset-max-ziplist-entries用ziplist，大于zset-max-ziplist-entries用zset。 <br>zset-max-ziplist-entries 128 <br><br>#value大小小于等于zset-max-ziplist-value用ziplist，大于zset-max-ziplist-value用zset。 <br>zset-max-ziplist-value 64 <br><br>#value大小小于等于hll-sparse-max-bytes使用稀疏数据结构（sparse），大于hll-sparse-max-bytes使用稠密的数据结构（dense）。<br>#一个比16000大的value是几乎没用的，建议的value大概为3000。<br>#如果对CPU要求不高，对空间要求较高的，建议设置到10000左右。 <br>hll-sparse-max-bytes 3000 <br><br>#Redis将在每100毫秒时使用1毫秒的CPU时间来对redis的hash表进行重新hash，可以降低内存的使用。<br>#当你的使用场景中，有非常严格的实时性需要，不能够接受Redis时不时的对请求有2毫秒的延迟的话，把这项配置为no。<br>#如果没有这么严格的实时性要求，可以设置为yes，以便能够尽可能快的释放内存。 <br>activerehashing yes <br><br>##对客户端输出缓冲进行限制可以强迫那些不从服务器读取数据的客户端断开连接，用来强制关闭传输缓慢的客户端。 <br>#对于normal client，第一个0表示取消hard limit，第二个0和第三个0表示取消soft limit，normal client默认取消限制，因为如果没有寻问，他们是不会接收数据的。 client-output-buffer-limit normal 0 0 0 <br>#对于slave client和MONITER client，如果client-output-buffer一旦超过256mb，又或者超过64mb持续60秒，那么服务器就会立即断开客户端连接。 <br>client-output-buffer-limit slave 256mb 64mb 60 <br><br>#对于pubsub client，如果client-output-buffer一旦超过32mb，又或者超过8mb持续60秒，那么服务器就会立即断开客户端连接。 <br>client-output-buffer-limit pubsub 32mb 8mb 60 <br><br>#redis执行任务的频率为1s除以hz。 hz 10 <br>#在aof重写的时候，如果打开了aof-rewrite-incremental-fsync开关，系统会每32MB执行一次fsync。<br>#这对于把文件写入磁盘是有帮助的，可以避免过大的延迟峰值。 <br>aof-rewrite-incremental-fsync yes<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>技术基础</category>
      
    </categories>
    
    
    <tags>
      
      <tag>程序员必备</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NodeJS基于Win系统的安装与配置</title>
    <link href="/2024/10/17/NodeJS%E5%9F%BA%E4%BA%8EWindows%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/"/>
    <url>/2024/10/17/NodeJS%E5%9F%BA%E4%BA%8EWindows%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/</url>
    
    <content type="html"><![CDATA[<h2 id="一、NodeJS的安装"><a href="#一、NodeJS的安装" class="headerlink" title="一、NodeJS的安装"></a>一、NodeJS的安装</h2><h3 id="1-1-下载NodeJS"><a href="#1-1-下载NodeJS" class="headerlink" title="1.1 下载NodeJS"></a>1.1 下载NodeJS</h3><p><a href="https://nodejs.org/zh-cn">Node.js 官方链接 (nodejs.org)</a></p><p><img src="https://cdn.jsdelivr.net/gh/awk001/hexo_pic/202410191128049.png" alt="Clip_2024-10-19_11-28-54"></p><h3 id="1-2-安装NodeJS"><a href="#1-2-安装NodeJS" class="headerlink" title="1.2 安装NodeJS"></a>1.2 安装NodeJS</h3><p>下载完成后，双击安装包，开始安装，一直点<code>next</code>即可，安装路径默认在<code>C:\Program Files</code>下，也可以自定义修改，如<code>D:\Programs\NodeJS</code></p><p>目前版本<code>Node.js v20.18.0</code>来说，使用.exe直接安装后，会默认将NodeJS的安装路径存储在环境变量中。</p><p>打开<code>cmd</code>窗口，查看node版本，当前版本同时也安装了Npm：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cmd">node -v<br>npm -v<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/awk001/hexo_pic/202410191129422.png" alt="Clip_2024-10-19_11-29-41"></p><h2 id="二、Npm包的配置优化"><a href="#二、Npm包的配置优化" class="headerlink" title="二、Npm包的配置优化"></a>二、Npm包的配置优化</h2><h3 id="2-1-npm下载加速"><a href="#2-1-npm下载加速" class="headerlink" title="2.1 npm下载加速"></a>2.1 npm下载加速</h3><p>默认的<code>npm</code>下载加速很慢，使用时可以使用第三方源加速使用</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cmd"># 淘宝镜像源<br>npm config <span class="hljs-built_in">set</span> registry https://registry.npmmirror.com<br></code></pre></td></tr></table></figure><h3 id="2-2-修改全局依赖包下载路径"><a href="#2-2-修改全局依赖包下载路径" class="headerlink" title="2.2 修改全局依赖包下载路径"></a>2.2 修改全局依赖包下载路径</h3><p>默认情况下，我们在执行<code>npm install -g XXXX</code>下载全局包时，这个包的默认存放路径位<code>C:\Users\用户名\AppData\Roaming\npm\node_modules下</code>，可以通过<code>CMD</code>指令<code>npm root -g</code>查看</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd"><span class="hljs-function">C:\<span class="hljs-title">Users</span>\<span class="hljs-title">Administer</span>\<span class="hljs-title">AppData</span>\<span class="hljs-title">Roaming</span>\<span class="hljs-title">npm</span>\<span class="hljs-title">node_modules</span></span><br></code></pre></td></tr></table></figure><p>但是有时候我们不想让全局包放在这里，我们可以自定义存放目录,在<code>CMD</code>窗口执行以下两条命令修改默认路径：</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs cmd"># 在NodeJS的安装目录下新增文件夹node_global和node_cache<br>npm config <span class="hljs-built_in">set</span> prefix &quot;D:\Programs\NodeJS\node_global&quot;<br>npm config <span class="hljs-built_in">set</span> cache &quot;D:\Programs\NodeJS\node_cache&quot;<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/awk001/hexo_pic/202410191130153.png" alt="Clip_2024-10-19_11-30-15"></p><h3 id="2-3-配置环境变量"><a href="#2-3-配置环境变量" class="headerlink" title="2.3 配置环境变量"></a>2.3 配置环境变量</h3><p>由于修改了全局包的下载路径，那么<code>npm</code>下载的全局包就会存放在<code>D:\Programs\NodeJS\node_global\node_modules</code>，而其对应的<code>cmd</code>指令会存放在<code>D:\Programs\NodeJS\node_global</code></p><p>我全局安装一个<code>hexo-cli</code>用来搭建博客</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmd">npm install -g hexo-cli<br></code></pre></td></tr></table></figure><p>安装完成后的依赖包：<code>D:\Programs\NodeJS\node_global\</code></p><p>已经安装的依赖程序文件夹：<code>D:\Programs\NodeJS\node_global\</code>&#x3D;&#x3D;node_modules\hexo-cli&#x3D;&#x3D;</p><p>那么此时我们想使用<code>hexo</code>指令时就必须是在已经修改的全局依赖包的路径下，将其路径<code>D:\Programs\NodeJS\node_global\</code>&#x3D;&#x3D;node_modules&#x3D;&#x3D;添加到系统变量即可。</p><p><img src="https://cdn.jsdelivr.net/gh/awk001/hexo_pic/202410191130836.png" alt="Clip_2024-10-19_11-30-38"></p><p>OK！大功告成！</p>]]></content>
    
    
    <categories>
      
      <category>技术基础</category>
      
    </categories>
    
    
    <tags>
      
      <tag>程序员必备</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
